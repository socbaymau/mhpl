@model IEnumerable<PhanPhoi>
@{
    ViewData["Title"] = "PhanPhoi";
    Layout = "~/Views/Shared/MenuLayout.cshtml";
}

<h2>PHÂN PHỐI</h2>
<div class="table">
    <button type="button" class="btn btn-info btn-sm format-button button" data-toggle="modal" data-target="#Them">Thêm</button>
    <form action="" class="search-form push-left">
        <div class="form-group has-feedback">
            <label for="search" class="sr-only">Search</label>
            <input type="text" class="form-control" name="search" id="search" placeholder="search">
            <span class="glyphicon glyphicon-search form-control-feedback"></span>
        </div>
    </form>
    <table class="table table-bordered table-hover table-loaiveso-noidung">
        <tr style="background-color:#abebe2">
            <th>Mã phân phối</th>
            <th>Mã vé số</th>
            <th>Mã đại lý</th>
            <th>Ngày phân phối</th>
            <th>Số lượng giao</th>
            <th>Số lượng bán</th>
            <th style="width: 50px;"></th>
        </tr>
        <tr>
            @foreach (var item in Model)
            {
                <td class="cmapp">@item.MaPp</td>
                @*<td class="cmavs">@item.MaLvs</td>*@
                <td class="cmadl">@item.MaDl</td>
                <td class="cngay">@item.Ngay</td>
                <td class="cslgiao">@item.SoLuongGiao</td>
                <td class="cslban">@item.SoLuongBan</td>
                <td>
                    <button type="button" class="btn btn-info btn-sm format-button btnSua" data-toggle="modal" data-target="#Sua">Sửa</button>
                </td>
            }

        </tr>
    </table>
    <div class="phantrang">
        <ul class="pagination modal-1">
            @if (ViewBag.TrangHienTai == 1)
            {
                <li><a><i class="fa fa-chevron-left"></i></a></li>
            }
            else
            {
                <li><a asp-controller="QuanLi" asp-action="PhanPhoi" asp-route-pagenumber="@Html.Raw(@ViewBag.TrangHienTai - 1)"><i class="fa fa-chevron-left"></i></a></li>
            }
            @for (int i = 1; i <= ViewBag.TongTrang; i++)
            {
                @if (i == ViewBag.TrangHienTai)
                {
                    <li><a><b>@i</b></a></li>
                }
                else
                {
                    <li><a asp-controller="QuanLi" asp-action="PhanPhoi" asp-route-pagenumber="@i">@i</a></li>
                }
            }
            @if (ViewBag.TrangHienTai == ViewBag.TongTrang)
            {
                <li><a><i class="fa fa-chevron-right"></i></a></li>
            }
            else
            {
                <li><a asp-controller="QuanLi" asp-action="PhanPhoi" asp-route-pagenumber="@Html.Raw(@ViewBag.TrangHienTai + 1)"><i class="fa fa-chevron-right"></i></a></li>
            }
        </ul>
    </div>
    <!-- Modal Them -->
    <form asp-action="ThemVS" asp-controller="QuanLi" method="post">
        <div id="Them" class="modal fade" role="dialog">
            <div class="modal-dialog">

                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Thêm</h4>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label for="usr">Mã phân phối:</label>
                            <input type="text" class="form-control" id="id" readonly>
                        </div>
                        <div class="form-group">
                            <label for="usr">Mã vé số:</label>
                            <input type="text" class="form-control" id="mvs">
                        </div>
                        <div class="form-group">
                            <label for="usr">Mã đại lý:</label>
                            <input type="text" class="form-control" id="mdl">
                        </div>
                        <div class="form-group">
                            <label for="usr">Ngày phân phối:</label>
                            <input type="date" class="form-control" id="npp">
                        </div>
                        <div class="form-group">
                            <label for="usr">Số lượng giao:</label>
                            <input type="number" class="form-control" id="slg">
                        </div>
                        <div class="form-group">
                            <label for="usr">Số lượng bán:</label>
                            <input type="number" class="form-control" id="slb">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" data-dismiss="modal">Save</button>
                        <button type="button" class="btn btn-warning" data-dismiss="modal">Close</button>
                    </div>
                </div>

            </div>
        </div>
    </form>
    <!-- Modal Sua-->
    <form asp-action="SuaPP" asp-controller="QuanLi" method="post">
        <div id="Sua" class="modal fade" role="dialog">
            <div class="modal-dialog">

                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Sửa</h4>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label for="usr">Mã phân phối:</label>
                            <input type="text" class="form-control editMaPP" id="id" name="mapp" readonly>
                        </div>
                        <div class="form-group">
                            <label for="usr">Mã vé số:</label>
                            <input type="text" class="form-control editMaVS" id="mvs" name="mavs">
                        </div>
                        <div class="form-group">
                            <label for="usr">Mã đại lý:</label>
                            <input type="text" class="form-control editMaDL" id="mdl" name="madl">
                        </div>
                        <div class="form-group">
                            <label for="usr">Ngày phân phối:</label>
                            <input type="date" class="form-control editNgayPP" id="npp" name="ngaypp">
                        </div>
                        <div class="form-group">
                            <label for="usr">Số lượng giao:</label>
                            <input type="number" class="form-control editSLGiao" id="slg" name="slgiao">
                        </div>
                        <div class="form-group">
                            <label for="usr">Số lượng bán:</label>
                            <input type="number" class="form-control editSLBan" id="slb" name="slban">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn btn-primary">Save</button>
                        <button type="button" class="btn btn-warning" data-dismiss="modal">Close</button>
                    </div>
                </div>

            </div>
        </div>
    </form>
</div>


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<link href="~/css/table.css" rel="stylesheet" />
<script>
    $(".btnSua").click(function () {
        var Mapp = $(this).closest('tr').find('.cmapp').text();
        var Mavs = $(this).closest('tr').find('.cmavs').text();
        var Madl = $(this).closest('tr').find('.cmadl').text();
        var Ngaypp = $(this).closest('tr').find('.cngay').text();
        var Slgiao = $(this).closest('tr').find('.cslgiao').text();
        var Slban = $(this).closest('tr').find('.cslban').text();

        $(".editMaPP").val(Mapp.trim());
        $(".editMaVS").val(Mavs.trim());
        $(".editMaDL").val(Madl.trim());
        $(".editNgayPP").val(Ngaypp.trim());
        $(".editSLGiao").val(Slgiao.trim());
        $(".editSLBan").val(Slban.trim());
    })
</script>
