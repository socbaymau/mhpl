@model IEnumerable<object>
@{
    List<WebApplication1.Models.Kqxs> lstkqxs = Model.ToList()[0] as List<WebApplication1.Models.Kqxs>;
    List<WebApplication1.Models.LoaiVeSo> lstlvs = Model.ToList()[1] as List<WebApplication1.Models.LoaiVeSo>;
    List<WebApplication1.Models.PhanPhoi> lstPP = Model.ToList()[2] as List<WebApplication1.Models.PhanPhoi>;
    List<WebApplication1.Models.Giai> lstG = Model.ToList()[3] as List<WebApplication1.Models.Giai>;
}
@{
    ViewData["Title"] = "KQXS";
    Layout = "~/Views/Shared/MenuLayout.cshtml";
}


<h2>KQXS</h2>

<div class="table">
    <button type="button" class="btn btn-info btn-sm format-button button" data-toggle="modal" data-target="#Them" onclick="get()">Thêm</button>
    @*<form action="" class="search-form push-left">
            <div class="form-group has-feedback">
                <label for="search" class="sr-only">Search</label>
                <input type="text" class="form-control" name="search" id="search" placeholder="search">
                <span class="glyphicon glyphicon-search form-control-feedback"></span>
            </div>
        </form>*@
    @*<div class="w3l_search">
            <form action="#" method="post" class="search-form push-left">
                <input type="text" name="search" value="Search" onfocus="this.value = '';" onblur="if (this.value == '') {this.value = 'Search';}" required="">
                <button class="btn btn-default" type="submit"><i class="fa fa-search" aria-hidden="true"></i></button>
            </form>
        </div>*@
    <form class="search-form" >

        <input type="text" class="form-control form-timkiem" placeholder="Tìm kiếm" id="search" name="search" />
        <button type="submit" class="btn btn-info btn-sm format-button button btn-search">
            @*<i class="fa fa-search"></i>*@
            Tìm
        </button>
    </form>
    <table class="table table-bordered table-hover table-loaiveso-noidung">
        <tr style="background-color:#abebe2">
            <th>Mã KQ</th>
            <th>Mã VS</th>
            <th>Giải</th>
            <th>Ngày</th>
            <th>KQ</th>
            <th>Tỉnh</th>
            <th style="width: 50px;"></th>
        </tr>

        @foreach (var item in lstkqxs)
        {
            <tr>
                <td class="kq_kqsx">
                    @Html.DisplayFor(modelItem => item.MaKq)
                </td>
                <td class="id">
                    @Html.DisplayFor(modelItem => item.MaLvs)
                </td>
                @foreach (var item1 in lstG)
                {
                    if (item.MaGiai == item1.MaGiai)
                    {
                        <td class="tinh">
                            @Html.DisplayFor(modelItem => item1.TenGiai)
                        </td>
                    }
                }
                <td class="tinhtrang">
                    @Html.DisplayFor(modelItem => item.Ngay)
                </td>
                <td class="ngay">
                    @Html.DisplayFor(modelItem => item.SoTrung)
                </td>
                @foreach (var item2 in lstlvs)
                {
                    if (item.MaLvs == item2.MaLvs)
                    {
                        <td class="tinh">
                            @Html.DisplayFor(modelItem => item2.Tinh)
                        </td>}
                }
                <td>
                    <button type="button" class="btn btn-info btn-sm format-button btnSua" data-toggle="modal" data-target="#Sua">Sửa</button>
                </td>
            </tr>
        }


    </table>

    <div class="table table-bordered table-hover table-loaiveso-noidung">
        <ul class="pagination modal-1">
            <li><a href="#" class="prev">&laquo</a></li>
            <li><a href="#" class="active">1</a></li>
            <li> <a href="#">2</a></li>
            <li> <a href="#">3</a></li>
            <li> <a href="#">4</a></li>
            <li> <a href="#">5</a></li>
            <li> <a href="#">6</a></li>
            <li> <a href="#">7</a></li>
            <li> <a href="#">8</a></li>
            <li> <a href="#">9</a></li>
            <li><a href="#" class="next">&raquo;</a></li>
        </ul>
    </div>
    <!-- Modal Them -->

    <form asp-action="ThemKQXS" asp-controller="QuanLi" method="post">

        <div id="Them" class="modal fade" role="dialog">
            <div class="modal-dialog">

                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Thêm</h4>
                    </div>
                    <div class="modal-body">
                        @*<div class="form-group">
                                <label for="usr">Id:</label>
                                <input type="text" class="form-control" id="id" disabled>
                            </div>*@
                        <div class="form-group">
                            <label for="usr">Mã KQ:</label>
                            <input type="text" class="form-control" id="mkq" readonly>
                        </div>
                        <div class="form-group">
                            <label for="usr">Mã VS:</label>
                            <input type="text" class="form-control" name="mavs">
                        </div>
                        <div class="form-group">
                            <label for="usr">Số Trúng:</label>
                            <input type="text" class="form-control" name="sotrung">
                        </div>
                        <div class="form-group">
                            <label for="usr">Giải</label>
                            <select class="form-control" id="tt" name="giai" style="width:150px">
                                @foreach (var item in lstG)
                                {
                                    <option value=@item.MaGiai> @item.TenGiai</option>}
                            </select>
                        </div>
                        <label for="usr">Mặc đinh là ngày hiện tại</label>


                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn btn-primary">Save</button>
                        <button type="button" class="btn btn-warning" data-dismiss="modal">Close</button>
                    </div>
                </div>

            </div>
        </div>
    </form>
    <!-- Modal Sua-->
    <form asp-action="SuaKQXS" asp-controller="QuanLi" method="post">
        <div id="Sua" class="modal fade" role="dialog">
            <div class="modal-dialog">

                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Sửa</h4>
                    </div>
                    <div class="modal-body">
                        @*<div class="form-group">
                                <label for="usr">Id:</label>
                                <input type="text" class="form-control" id="id" disabled>
                            </div>*@
                        <div class="form-group">
                            <label for="usr">Mã KQ:</label>
                            <input type="text" class="form-control makq-edit" id="mkq" name="makq" readonly>

                        </div>
                        <div class="form-group">
                            <label for="usr">Mã vé số:</label>
                            <input type="text" class="form-control ma-edit" id="mvs" name="edMaVS">

                        </div>
                        <div class="form-group">
                            <label for="usr">Giải</label>
                            <select class="form-control" id="tt" name="edGiai" style="width:150px">
                                @foreach (var item in lstG)
                                {
                                    <option value=@item.MaGiai> @item.TenGiai</option>}
                            </select>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn btn-primary">Save</button>
                        <button type="button" class="btn btn-warning" data-dismiss="modal">Close</button>
                    </div>
                </div>

            </div>
        </div>
    </form>
</div>


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<link href="~/css/table.css" rel="stylesheet" />
@*<link href="~/css/style2.css" rel="stylesheet" />*@
<script>
    $(".btnSua").click(function () {
        var Ma = $(this).closest('tr').find('.id').text();
        var Makq = $(this).closest('tr').find('.kq_kqsx').text();
        var sTinhTrang = $(this).closest('tr').find('.tinhtrang').text();
        $(".ma-edit").val(Ma.trim());
        $(".makq-edit").val(Makq.trim());
    })
</script>
